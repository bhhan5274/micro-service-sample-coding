<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=edge"/>
<title>Test results - Class io.github.bhhan.example.apigateway.proxy.CustomerServiceProxyTest</title>
<link href="../css/base-style.css" rel="stylesheet" type="text/css"/>
<link href="../css/style.css" rel="stylesheet" type="text/css"/>
<script src="../js/report.js" type="text/javascript"></script>
</head>
<body>
<div id="content">
<h1>Class io.github.bhhan.example.apigateway.proxy.CustomerServiceProxyTest</h1>
<div class="breadcrumbs">
<a href="../index.html">all</a> &gt; 
<a href="../packages/io.github.bhhan.example.apigateway.proxy.html">io.github.bhhan.example.apigateway.proxy</a> &gt; CustomerServiceProxyTest</div>
<div id="summary">
<table>
<tr>
<td>
<div class="summaryGroup">
<table>
<tr>
<td>
<div class="infoBox" id="tests">
<div class="counter">2</div>
<p>tests</p>
</div>
</td>
<td>
<div class="infoBox" id="failures">
<div class="counter">0</div>
<p>failures</p>
</div>
</td>
<td>
<div class="infoBox" id="ignored">
<div class="counter">0</div>
<p>ignored</p>
</div>
</td>
<td>
<div class="infoBox" id="duration">
<div class="counter">3.101s</div>
<p>duration</p>
</div>
</td>
</tr>
</table>
</div>
</td>
<td>
<div class="infoBox success" id="successRate">
<div class="percent">100%</div>
<p>successful</p>
</div>
</td>
</tr>
</table>
</div>
<div id="tabs">
<ul class="tabLinks">
<li>
<a href="#tab0">Tests</a>
</li>
<li>
<a href="#tab1">Standard output</a>
</li>
</ul>
<div id="tab0" class="tab">
<h2>Tests</h2>
<table>
<thead>
<tr>
<th>Test</th>
<th>Duration</th>
<th>Result</th>
</tr>
</thead>
<tr>
<td class="success">shouldCallCustomerService</td>
<td class="success">2.559s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldTimeoutAndTripCircuitBreaker</td>
<td class="success">0.542s</td>
<td class="success">passed</td>
</tr>
</table>
</div>
<div id="tab1" class="tab">
<h2>Standard output</h2>
<span class="code">
<pre>17:11:31.565 [Test worker] DEBUG org.springframework.test.context.junit4.SpringJUnit4ClassRunner - SpringJUnit4ClassRunner constructor called with [class io.github.bhhan.example.apigateway.proxy.CustomerServiceProxyTest]
17:11:31.576 [Test worker] DEBUG org.springframework.test.context.BootstrapUtils - Instantiating CacheAwareContextLoaderDelegate from class [org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate]
17:11:31.589 [Test worker] DEBUG org.springframework.test.context.BootstrapUtils - Instantiating BootstrapContext using constructor [public org.springframework.test.context.support.DefaultBootstrapContext(java.lang.Class,org.springframework.test.context.CacheAwareContextLoaderDelegate)]
17:11:31.651 [Test worker] DEBUG org.springframework.test.context.BootstrapUtils - Instantiating TestContextBootstrapper for test class [io.github.bhhan.example.apigateway.proxy.CustomerServiceProxyTest] from class [org.springframework.boot.test.context.SpringBootTestContextBootstrapper]
17:11:31.685 [Test worker] INFO org.springframework.boot.test.context.SpringBootTestContextBootstrapper - Neither @ContextConfiguration nor @ContextHierarchy found for test class [io.github.bhhan.example.apigateway.proxy.CustomerServiceProxyTest], using SpringBootContextLoader
17:11:31.709 [Test worker] DEBUG org.springframework.test.context.support.AbstractContextLoader - Did not detect default resource location for test class [io.github.bhhan.example.apigateway.proxy.CustomerServiceProxyTest]: class path resource [io/github/bhhan/example/apigateway/proxy/CustomerServiceProxyTest-context.xml] does not exist
17:11:31.710 [Test worker] DEBUG org.springframework.test.context.support.AbstractContextLoader - Did not detect default resource location for test class [io.github.bhhan.example.apigateway.proxy.CustomerServiceProxyTest]: class path resource [io/github/bhhan/example/apigateway/proxy/CustomerServiceProxyTestContext.groovy] does not exist
17:11:31.711 [Test worker] INFO org.springframework.test.context.support.AbstractContextLoader - Could not detect default resource locations for test class [io.github.bhhan.example.apigateway.proxy.CustomerServiceProxyTest]: no resource found for suffixes {-context.xml, Context.groovy}.
17:11:31.889 [Test worker] DEBUG org.springframework.test.context.support.ActiveProfilesUtils - Could not find an 'annotation declaring class' for annotation type [org.springframework.test.context.ActiveProfiles] and class [io.github.bhhan.example.apigateway.proxy.CustomerServiceProxyTest]
17:11:32.110 [Test worker] DEBUG org.springframework.boot.test.context.SpringBootTestContextBootstrapper - @TestExecutionListeners is not present for class [io.github.bhhan.example.apigateway.proxy.CustomerServiceProxyTest]: using defaults.
17:11:32.111 [Test worker] INFO org.springframework.boot.test.context.SpringBootTestContextBootstrapper - Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.cloud.contract.stubrunner.provider.wiremock.StubRunnerWireMockTestExecutionListener, org.springframework.cloud.contract.wiremock.WireMockTestExecutionListener, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener, org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener, org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener, org.springframework.test.context.event.EventPublishingTestExecutionListener]
17:11:32.137 [Test worker] DEBUG org.springframework.boot.test.context.SpringBootTestContextBootstrapper - Skipping candidate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener] due to a missing dependency. Specify custom listener classes or make the default listener classes and their required dependencies available. Offending class: [javax/servlet/ServletContext]
17:11:32.162 [Test worker] INFO org.springframework.boot.test.context.SpringBootTestContextBootstrapper - Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@7c044875, org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener@4b5ac76b, org.springframework.boot.test.autoconfigure.SpringBootDependencyInjectionTestExecutionListener@2e3bcee8, org.springframework.test.context.support.DirtiesContextTestExecutionListener@635d7228, org.springframework.test.context.transaction.TransactionalTestExecutionListener@3dc4d9d6, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@20b8309a, org.springframework.test.context.event.EventPublishingTestExecutionListener@5004e6eb, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener@584012f1, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener@43d16a46, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener@228cbe46, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener@55c83742, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener@dc77090, org.springframework.cloud.contract.stubrunner.provider.wiremock.StubRunnerWireMockTestExecutionListener@458cb834, org.springframework.cloud.contract.wiremock.WireMockTestExecutionListener@2b5404d]
17:11:32.170 [Test worker] DEBUG org.springframework.test.annotation.ProfileValueUtils - Retrieved @ProfileValueSourceConfiguration [null] for test class [io.github.bhhan.example.apigateway.proxy.CustomerServiceProxyTest]
17:11:32.173 [Test worker] DEBUG org.springframework.test.annotation.ProfileValueUtils - Retrieved ProfileValueSource type [class org.springframework.test.annotation.SystemProfileValueSource] for class [io.github.bhhan.example.apigateway.proxy.CustomerServiceProxyTest]
17:11:32.178 [Test worker] DEBUG org.springframework.test.annotation.ProfileValueUtils - Retrieved @ProfileValueSourceConfiguration [null] for test class [io.github.bhhan.example.apigateway.proxy.CustomerServiceProxyTest]
17:11:32.179 [Test worker] DEBUG org.springframework.test.annotation.ProfileValueUtils - Retrieved ProfileValueSource type [class org.springframework.test.annotation.SystemProfileValueSource] for class [io.github.bhhan.example.apigateway.proxy.CustomerServiceProxyTest]
17:11:32.181 [Test worker] DEBUG org.springframework.test.annotation.ProfileValueUtils - Retrieved @ProfileValueSourceConfiguration [null] for test class [io.github.bhhan.example.apigateway.proxy.CustomerServiceProxyTest]
17:11:32.182 [Test worker] DEBUG org.springframework.test.annotation.ProfileValueUtils - Retrieved ProfileValueSource type [class org.springframework.test.annotation.SystemProfileValueSource] for class [io.github.bhhan.example.apigateway.proxy.CustomerServiceProxyTest]
17:11:32.190 [Test worker] DEBUG org.springframework.test.context.support.AbstractDirtiesContextTestExecutionListener - Before test class: context [DefaultTestContext@788d91bf testClass = CustomerServiceProxyTest, testInstance = [null], testMethod = [null], testException = [null], mergedContextConfiguration = [ReactiveWebMergedContextConfiguration@6014477d testClass = CustomerServiceProxyTest, locations = '{}', classes = '{class io.github.bhhan.example.apigateway.proxy.CustomerServiceProxyTest$Config, class io.github.bhhan.example.apigateway.proxy.CustomerServiceProxyTest$Config}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{customer.destinations.customerServiceUrl=http://localhost:${wiremock.server.port}, order.destinations.orderServiceUrl=http://localhost:${wiremock.server.port}, org.springframework.boot.test.context.SpringBootTestContextBootstrapper=true, server.port=0}', contextCustomizers = set[org.springframework.boot.test.autoconfigure.properties.PropertyMappingContextCustomizer@810a4749, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverContextCustomizerFactory$Customizer@3789637, [ImportsContextCustomizer@325236fe key = [org.springframework.cloud.contract.wiremock.WireMockRestTemplateConfiguration, org.springframework.cloud.contract.wiremock.WireMockConfiguration]], org.springframework.boot.test.context.filter.ExcludeFilterContextCustomizer@6b1296d4, org.springframework.boot.test.json.DuplicateJsonObjectContextCustomizerFactory$DuplicateJsonObjectContextCustomizer@3d774912, org.springframework.boot.test.mock.mockito.MockitoContextCustomizer@0, org.springframework.boot.test.web.client.TestRestTemplateContextCustomizer@4bb810e6, org.springframework.boot.test.web.reactive.server.WebTestClientContextCustomizer@48b90159], contextLoader = 'org.springframework.boot.test.context.SpringBootContextLoader', parent = [null]], attributes = map['org.springframework.test.context.web.ServletTestExecutionListener.activateListener' -&gt; false]], class annotated with @DirtiesContext [false] with mode [null].
17:11:32.269 [Test worker] DEBUG org.springframework.test.context.support.TestPropertySourceUtils - Adding inlined properties to environment: {spring.jmx.enabled=false, customer.destinations.customerServiceUrl=http://localhost:${wiremock.server.port}, order.destinations.orderServiceUrl=http://localhost:${wiremock.server.port}, org.springframework.boot.test.context.SpringBootTestContextBootstrapper=true, server.port=0}

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::        (v2.2.5.RELEASE)

2021-01-14 17:11:37.088  INFO [api-gateway,,,] 2148 --- [    Test worker] i.g.b.e.a.p.CustomerServiceProxyTest     : No active profile set, falling back to default profiles: default
2021-01-14 17:11:38.246  INFO [api-gateway,,,] 2148 --- [    Test worker] i.g.r.utils.RxJava2OnClasspathCondition  : RxJava2 related Aspect extensions are not activated, because RxJava2 is not on the classpath.
2021-01-14 17:11:38.280  INFO [api-gateway,,,] 2148 --- [    Test worker] i.g.r.utils.RxJava2OnClasspathCondition  : RxJava2 related Aspect extensions are not activated, because RxJava2 is not on the classpath.
2021-01-14 17:11:38.313  INFO [api-gateway,,,] 2148 --- [    Test worker] i.g.r.utils.RxJava2OnClasspathCondition  : RxJava2 related Aspect extensions are not activated, because RxJava2 is not on the classpath.
2021-01-14 17:11:38.348  INFO [api-gateway,,,] 2148 --- [    Test worker] i.g.r.utils.RxJava2OnClasspathCondition  : RxJava2 related Aspect extensions are not activated, because RxJava2 is not on the classpath.
2021-01-14 17:11:38.392  INFO [api-gateway,,,] 2148 --- [    Test worker] i.g.r.utils.RxJava2OnClasspathCondition  : RxJava2 related Aspect extensions are not activated, because RxJava2 is not on the classpath.
2021-01-14 17:11:39.492  INFO [api-gateway,,,] 2148 --- [    Test worker] o.s.cloud.context.scope.GenericScope     : BeanFactory id=e6838a94-e47b-35ff-a2ee-8fb784e4702f
2021-01-14 17:11:43.278  INFO [api-gateway,,,] 2148 --- [    Test worker] wiremock.org.eclipse.jetty.util.log      : Logging initialized @14407ms to wiremock.org.eclipse.jetty.util.log.Slf4jLog
2021-01-14 17:11:43.690  INFO [api-gateway,,,] 2148 --- [    Test worker] w.org.eclipse.jetty.server.Server        : jetty-9.4.20.v20190813; built: 2019-08-13T21:28:18.144Z; git: 84700530e645e812b336747464d6fbbf370c9a20; jvm 1.8.0_191-b12
2021-01-14 17:11:43.729  INFO [api-gateway,,,] 2148 --- [    Test worker] w.o.e.j.server.handler.ContextHandler    : Started w.o.e.j.s.ServletContextHandler@7d48e888{/__admin,null,AVAILABLE}
2021-01-14 17:11:43.732  INFO [api-gateway,,,] 2148 --- [    Test worker] w.o.e.j.server.handler.ContextHandler    : Started w.o.e.j.s.ServletContextHandler@34cfcb4c{/,null,AVAILABLE}
2021-01-14 17:11:43.769  INFO [api-gateway,,,] 2148 --- [    Test worker] w.o.e.jetty.server.AbstractConnector     : Started NetworkTrafficServerConnector@33c5b26a{HTTP/1.1,[http/1.1]}{0.0.0.0:10879}
2021-01-14 17:11:43.770  INFO [api-gateway,,,] 2148 --- [    Test worker] w.org.eclipse.jetty.server.Server        : Started @14901ms
2021-01-14 17:11:45.925  INFO [api-gateway,,,] 2148 --- [    Test worker] uration$$EnhancerBySpringCGLIB$$bab89f81 : apiGatewayTimeoutMillis=2000
2021-01-14 17:11:52.725  INFO [api-gateway,,,] 2148 --- [    Test worker] o.s.c.g.r.RouteDefinitionRouteLocator    : Loaded RoutePredicateFactory [After]
2021-01-14 17:11:52.726  INFO [api-gateway,,,] 2148 --- [    Test worker] o.s.c.g.r.RouteDefinitionRouteLocator    : Loaded RoutePredicateFactory [Before]
2021-01-14 17:11:52.728  INFO [api-gateway,,,] 2148 --- [    Test worker] o.s.c.g.r.RouteDefinitionRouteLocator    : Loaded RoutePredicateFactory [Between]
2021-01-14 17:11:52.728  INFO [api-gateway,,,] 2148 --- [    Test worker] o.s.c.g.r.RouteDefinitionRouteLocator    : Loaded RoutePredicateFactory [Cookie]
2021-01-14 17:11:52.729  INFO [api-gateway,,,] 2148 --- [    Test worker] o.s.c.g.r.RouteDefinitionRouteLocator    : Loaded RoutePredicateFactory [Header]
2021-01-14 17:11:52.729  INFO [api-gateway,,,] 2148 --- [    Test worker] o.s.c.g.r.RouteDefinitionRouteLocator    : Loaded RoutePredicateFactory [Host]
2021-01-14 17:11:52.730  INFO [api-gateway,,,] 2148 --- [    Test worker] o.s.c.g.r.RouteDefinitionRouteLocator    : Loaded RoutePredicateFactory [Method]
2021-01-14 17:11:52.730  INFO [api-gateway,,,] 2148 --- [    Test worker] o.s.c.g.r.RouteDefinitionRouteLocator    : Loaded RoutePredicateFactory [Path]
2021-01-14 17:11:52.731  INFO [api-gateway,,,] 2148 --- [    Test worker] o.s.c.g.r.RouteDefinitionRouteLocator    : Loaded RoutePredicateFactory [Query]
2021-01-14 17:11:52.732  INFO [api-gateway,,,] 2148 --- [    Test worker] o.s.c.g.r.RouteDefinitionRouteLocator    : Loaded RoutePredicateFactory [ReadBodyPredicateFactory]
2021-01-14 17:11:52.735  INFO [api-gateway,,,] 2148 --- [    Test worker] o.s.c.g.r.RouteDefinitionRouteLocator    : Loaded RoutePredicateFactory [RemoteAddr]
2021-01-14 17:11:52.736  INFO [api-gateway,,,] 2148 --- [    Test worker] o.s.c.g.r.RouteDefinitionRouteLocator    : Loaded RoutePredicateFactory [Weight]
2021-01-14 17:11:52.736  INFO [api-gateway,,,] 2148 --- [    Test worker] o.s.c.g.r.RouteDefinitionRouteLocator    : Loaded RoutePredicateFactory [CloudFoundryRouteService]
2021-01-14 17:11:57.174  INFO [api-gateway,,,] 2148 --- [    Test worker] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 2 endpoint(s) beneath base path '/actuator'
2021-01-14 17:12:04.900  INFO [api-gateway,,,] 2148 --- [    Test worker] o.s.b.web.embedded.netty.NettyWebServer  : Netty started on port(s): 6083
2021-01-14 17:12:06.564  INFO [api-gateway,,,] 2148 --- [    Test worker] i.g.b.e.a.p.CustomerServiceProxyTest     : Started CustomerServiceProxyTest in 34.287 seconds (JVM running for 37.696)
2021-01-14 17:12:06.579  INFO [api-gateway,,,] 2148 --- [    Test worker] w.o.e.jetty.server.AbstractConnector     : Stopped NetworkTrafficServerConnector@33c5b26a{HTTP/1.1,[http/1.1]}{0.0.0.0:10879}
2021-01-14 17:12:06.582  INFO [api-gateway,,,] 2148 --- [    Test worker] w.o.e.j.server.handler.ContextHandler    : Stopped w.o.e.j.s.ServletContextHandler@34cfcb4c{/,null,UNAVAILABLE}
2021-01-14 17:12:06.583  INFO [api-gateway,,,] 2148 --- [    Test worker] w.o.e.j.server.handler.ContextHandler    : Stopped w.o.e.j.s.ServletContextHandler@7d48e888{/__admin,null,UNAVAILABLE}
2021-01-14 17:12:06.594  INFO [api-gateway,,,] 2148 --- [    Test worker] w.org.eclipse.jetty.server.Server        : jetty-9.4.20.v20190813; built: 2019-08-13T21:28:18.144Z; git: 84700530e645e812b336747464d6fbbf370c9a20; jvm 1.8.0_191-b12
2021-01-14 17:12:06.597  INFO [api-gateway,,,] 2148 --- [    Test worker] w.o.e.j.server.handler.ContextHandler    : Started w.o.e.j.s.ServletContextHandler@7031fd0a{/__admin,null,AVAILABLE}
2021-01-14 17:12:06.597  INFO [api-gateway,,,] 2148 --- [    Test worker] w.o.e.j.server.handler.ContextHandler    : Started w.o.e.j.s.ServletContextHandler@725179b0{/,null,AVAILABLE}
2021-01-14 17:12:06.601  INFO [api-gateway,,,] 2148 --- [    Test worker] w.o.e.jetty.server.AbstractConnector     : Started NetworkTrafficServerConnector@15824b7b{HTTP/1.1,[http/1.1]}{0.0.0.0:10879}
2021-01-14 17:12:06.601  INFO [api-gateway,,,] 2148 --- [    Test worker] w.org.eclipse.jetty.server.Server        : Started @37733ms
2021-01-14 17:12:08.215  INFO [api-gateway,,,] 2148 --- [tp1285875672-41] w.org.eclipse.jetty.util.TypeUtil        : JVM Runtime does not support Modules
2021-01-14 17:12:08.256  INFO [api-gateway,,,] 2148 --- [tp1285875672-41] w.o.e.j.s.handler.ContextHandler.ROOT    : RequestHandlerClass from context returned com.github.tomakehurst.wiremock.http.StubRequestHandler. Normalized mapped under returned 'null'
2021-01-14 17:12:08.868  INFO [api-gateway,,,] 2148 --- [tp1285875672-41] WireMock                                 : Request received:
127.0.0.1 - GET /customers/101

Accept: [*/*]
X-B3-SpanId: [b4dd48820c4adabe]
User-Agent: [ReactorNetty/0.9.5.RELEASE]
X-B3-Sampled: [1]
Host: [localhost:10879]
X-B3-TraceId: [b4dd48820c4adabe]
Accept-Encoding: [gzip]



Matched response definition:
{
  &quot;status&quot; : 200,
  &quot;body&quot; : &quot;{\&quot;customerId\&quot;:101,\&quot;name\&quot;:\&quot;Fred\&quot;,\&quot;creditLimit\&quot;:\&quot;12.34\&quot;}&quot;,
  &quot;headers&quot; : {
    &quot;Content-Type&quot; : &quot;application/json&quot;
  }
}

Response:
HTTP/1.1 200
Content-Type: [application/json]
Matched-Stub-Id: [3efd88c8-6c7e-4bdc-b952-848056ef67a6]


2021-01-14 17:12:09.150 DEBUG [api-gateway,,,] 2148 --- [ctor-http-nio-2] i.g.r.c.i.CircuitBreakerStateMachine     : Event SUCCESS published: 2021-01-14T17:12:09.149+09:00[Asia/Seoul]: CircuitBreaker 'MY_CIRCUIT_BREAKER' recorded a successful call. Elapsed time: 1409 ms
2021-01-14 17:12:09.198  INFO [api-gateway,,,] 2148 --- [tp1285875672-37] WireMock                                 : Request received:
127.0.0.1 - GET /customers/99

Accept: [*/*]
X-B3-SpanId: [71a5ae98e234a04c]
User-Agent: [ReactorNetty/0.9.5.RELEASE]
X-B3-Sampled: [1]
Host: [localhost:10879]
X-B3-TraceId: [71a5ae98e234a04c]
Accept-Encoding: [gzip]



Matched response definition:
{
  &quot;status&quot; : 500,
  &quot;body&quot; : &quot;{}&quot;,
  &quot;headers&quot; : {
    &quot;Content-Type&quot; : &quot;application/json&quot;
  }
}

Response:
HTTP/1.1 500
Content-Type: [application/json]
Matched-Stub-Id: [f49d770b-85ae-4fb1-a5f4-c283064d534b]


2021-01-14 17:12:09.212 DEBUG [api-gateway,,,] 2148 --- [ctor-http-nio-2] i.g.r.c.i.CircuitBreakerStateMachine     : CircuitBreaker 'MY_CIRCUIT_BREAKER' recorded an exception as failure:

io.github.bhhan.example.apigateway.proxy.UnknownProxyException: Unknown: 500 INTERNAL_SERVER_ERROR
	at io.github.bhhan.example.apigateway.proxy.CustomerServiceProxy.lambda$findCustomerById$0(CustomerServiceProxy.java:46) ~[main/:na]
	at reactor.core.publisher.MonoFlatMap$FlatMapMain.onNext(MonoFlatMap.java:118) ~[reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber.onNext(FluxSwitchIfEmpty.java:67) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxOnAssembly$OnAssemblySubscriber.onNext(FluxOnAssembly.java:385) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at org.springframework.cloud.sleuth.instrument.web.client.TraceExchangeFilterFunction$WebClientTracerSubscriber.onNext(TraceWebClientBeanPostProcessor.java:269) [spring-cloud-sleuth-core-2.2.2.RELEASE.jar:2.2.2.RELEASE]
	at org.springframework.cloud.sleuth.instrument.web.client.TraceExchangeFilterFunction$WebClientTracerSubscriber.onNext(TraceWebClientBeanPostProcessor.java:202) [spring-cloud-sleuth-core-2.2.2.RELEASE.jar:2.2.2.RELEASE]
	at reactor.core.publisher.FluxMap$MapSubscriber.onNext(FluxMap.java:114) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxPeek$PeekSubscriber.onNext(FluxPeek.java:192) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxPeek$PeekSubscriber.onNext(FluxPeek.java:192) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoNext$NextSubscriber.onNext(MonoNext.java:76) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyInner.onNext(MonoFlatMapMany.java:242) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2267) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyMain.onSubscribeInner(MonoFlatMapMany.java:143) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyInner.onSubscribe(MonoFlatMapMany.java:237) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:54) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.Flux.subscribe(Flux.java:8186) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyMain.onNext(MonoFlatMapMany.java:188) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxRetryPredicate$RetryPredicateSubscriber.onNext(FluxRetryPredicate.java:82) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoCreate$DefaultMonoSink.success(MonoCreate.java:156) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.netty.http.client.HttpClientConnect$HttpObserver.onStateChange(HttpClientConnect.java:398) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.ReactorNetty$CompositeConnectionObserver.onStateChange(ReactorNetty.java:514) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.resources.PooledConnectionProvider$DisposableAcquire.onStateChange(PooledConnectionProvider.java:501) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.resources.PooledConnectionProvider$PooledConnection.onStateChange(PooledConnectionProvider.java:413) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.http.client.HttpClientOperations.onInboundNext(HttpClientOperations.java:550) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.channel.ChannelOperationsHandler.channelRead(ChannelOperationsHandler.java:90) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:321) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:308) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:422) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:276) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:714) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:650) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:576) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:493) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_191]

2021-01-14 17:12:09.214 DEBUG [api-gateway,,,] 2148 --- [ctor-http-nio-2] i.g.r.c.i.CircuitBreakerStateMachine     : Event ERROR published: 2021-01-14T17:12:09.214+09:00[Asia/Seoul]: CircuitBreaker 'MY_CIRCUIT_BREAKER' recorded an error: 'io.github.bhhan.example.apigateway.proxy.UnknownProxyException: Unknown: 500 INTERNAL_SERVER_ERROR'. Elapsed time: 17 ms
2021-01-14 17:12:09.248  INFO [api-gateway,,,] 2148 --- [tp1285875672-40] WireMock                                 : Request received:
127.0.0.1 - GET /customers/99

Accept: [*/*]
X-B3-SpanId: [ed5458f7a1c034a3]
User-Agent: [ReactorNetty/0.9.5.RELEASE]
X-B3-Sampled: [1]
Host: [localhost:10879]
X-B3-TraceId: [ed5458f7a1c034a3]
Accept-Encoding: [gzip]



Matched response definition:
{
  &quot;status&quot; : 500,
  &quot;body&quot; : &quot;{}&quot;,
  &quot;headers&quot; : {
    &quot;Content-Type&quot; : &quot;application/json&quot;
  }
}

Response:
HTTP/1.1 500
Content-Type: [application/json]
Matched-Stub-Id: [f49d770b-85ae-4fb1-a5f4-c283064d534b]


2021-01-14 17:12:09.256 DEBUG [api-gateway,,,] 2148 --- [ctor-http-nio-2] i.g.r.c.i.CircuitBreakerStateMachine     : CircuitBreaker 'MY_CIRCUIT_BREAKER' recorded an exception as failure:

io.github.bhhan.example.apigateway.proxy.UnknownProxyException: Unknown: 500 INTERNAL_SERVER_ERROR
	at io.github.bhhan.example.apigateway.proxy.CustomerServiceProxy.lambda$findCustomerById$0(CustomerServiceProxy.java:46) ~[main/:na]
	at reactor.core.publisher.MonoFlatMap$FlatMapMain.onNext(MonoFlatMap.java:118) ~[reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber.onNext(FluxSwitchIfEmpty.java:67) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxOnAssembly$OnAssemblySubscriber.onNext(FluxOnAssembly.java:385) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at org.springframework.cloud.sleuth.instrument.web.client.TraceExchangeFilterFunction$WebClientTracerSubscriber.onNext(TraceWebClientBeanPostProcessor.java:269) [spring-cloud-sleuth-core-2.2.2.RELEASE.jar:2.2.2.RELEASE]
	at org.springframework.cloud.sleuth.instrument.web.client.TraceExchangeFilterFunction$WebClientTracerSubscriber.onNext(TraceWebClientBeanPostProcessor.java:202) [spring-cloud-sleuth-core-2.2.2.RELEASE.jar:2.2.2.RELEASE]
	at reactor.core.publisher.FluxMap$MapSubscriber.onNext(FluxMap.java:114) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxPeek$PeekSubscriber.onNext(FluxPeek.java:192) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxPeek$PeekSubscriber.onNext(FluxPeek.java:192) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoNext$NextSubscriber.onNext(MonoNext.java:76) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyInner.onNext(MonoFlatMapMany.java:242) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2267) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyMain.onSubscribeInner(MonoFlatMapMany.java:143) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyInner.onSubscribe(MonoFlatMapMany.java:237) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:54) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.Flux.subscribe(Flux.java:8186) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyMain.onNext(MonoFlatMapMany.java:188) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxRetryPredicate$RetryPredicateSubscriber.onNext(FluxRetryPredicate.java:82) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoCreate$DefaultMonoSink.success(MonoCreate.java:156) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.netty.http.client.HttpClientConnect$HttpObserver.onStateChange(HttpClientConnect.java:398) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.ReactorNetty$CompositeConnectionObserver.onStateChange(ReactorNetty.java:514) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.resources.PooledConnectionProvider$DisposableAcquire.onStateChange(PooledConnectionProvider.java:501) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.resources.PooledConnectionProvider$PooledConnection.onStateChange(PooledConnectionProvider.java:413) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.http.client.HttpClientOperations.onInboundNext(HttpClientOperations.java:550) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.channel.ChannelOperationsHandler.channelRead(ChannelOperationsHandler.java:90) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:321) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:308) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:422) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:276) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:714) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:650) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:576) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:493) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_191]

2021-01-14 17:12:09.258 DEBUG [api-gateway,,,] 2148 --- [ctor-http-nio-2] i.g.r.c.i.CircuitBreakerStateMachine     : Event ERROR published: 2021-01-14T17:12:09.257+09:00[Asia/Seoul]: CircuitBreaker 'MY_CIRCUIT_BREAKER' recorded an error: 'io.github.bhhan.example.apigateway.proxy.UnknownProxyException: Unknown: 500 INTERNAL_SERVER_ERROR'. Elapsed time: 23 ms
2021-01-14 17:12:09.336  INFO [api-gateway,,,] 2148 --- [tp1285875672-39] WireMock                                 : Request received:
127.0.0.1 - GET /customers/99

Accept: [*/*]
X-B3-SpanId: [d92608a5674f6b08]
User-Agent: [ReactorNetty/0.9.5.RELEASE]
X-B3-Sampled: [1]
Host: [localhost:10879]
X-B3-TraceId: [d92608a5674f6b08]
Accept-Encoding: [gzip]



Matched response definition:
{
  &quot;status&quot; : 500,
  &quot;body&quot; : &quot;{}&quot;,
  &quot;headers&quot; : {
    &quot;Content-Type&quot; : &quot;application/json&quot;
  }
}

Response:
HTTP/1.1 500
Content-Type: [application/json]
Matched-Stub-Id: [f49d770b-85ae-4fb1-a5f4-c283064d534b]


2021-01-14 17:12:09.341 DEBUG [api-gateway,,,] 2148 --- [ctor-http-nio-3] i.g.r.c.i.CircuitBreakerStateMachine     : CircuitBreaker 'MY_CIRCUIT_BREAKER' recorded an exception as failure:

io.github.bhhan.example.apigateway.proxy.UnknownProxyException: Unknown: 500 INTERNAL_SERVER_ERROR
	at io.github.bhhan.example.apigateway.proxy.CustomerServiceProxy.lambda$findCustomerById$0(CustomerServiceProxy.java:46) ~[main/:na]
	at reactor.core.publisher.MonoFlatMap$FlatMapMain.onNext(MonoFlatMap.java:118) ~[reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber.onNext(FluxSwitchIfEmpty.java:67) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxOnAssembly$OnAssemblySubscriber.onNext(FluxOnAssembly.java:385) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at org.springframework.cloud.sleuth.instrument.web.client.TraceExchangeFilterFunction$WebClientTracerSubscriber.onNext(TraceWebClientBeanPostProcessor.java:269) [spring-cloud-sleuth-core-2.2.2.RELEASE.jar:2.2.2.RELEASE]
	at org.springframework.cloud.sleuth.instrument.web.client.TraceExchangeFilterFunction$WebClientTracerSubscriber.onNext(TraceWebClientBeanPostProcessor.java:202) [spring-cloud-sleuth-core-2.2.2.RELEASE.jar:2.2.2.RELEASE]
	at reactor.core.publisher.FluxMap$MapSubscriber.onNext(FluxMap.java:114) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxPeek$PeekSubscriber.onNext(FluxPeek.java:192) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxPeek$PeekSubscriber.onNext(FluxPeek.java:192) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoNext$NextSubscriber.onNext(MonoNext.java:76) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyInner.onNext(MonoFlatMapMany.java:242) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2267) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyMain.onSubscribeInner(MonoFlatMapMany.java:143) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyInner.onSubscribe(MonoFlatMapMany.java:237) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:54) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.Flux.subscribe(Flux.java:8186) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyMain.onNext(MonoFlatMapMany.java:188) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxRetryPredicate$RetryPredicateSubscriber.onNext(FluxRetryPredicate.java:82) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoCreate$DefaultMonoSink.success(MonoCreate.java:156) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.netty.http.client.HttpClientConnect$HttpObserver.onStateChange(HttpClientConnect.java:398) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.ReactorNetty$CompositeConnectionObserver.onStateChange(ReactorNetty.java:514) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.resources.PooledConnectionProvider$DisposableAcquire.onStateChange(PooledConnectionProvider.java:501) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.resources.PooledConnectionProvider$PooledConnection.onStateChange(PooledConnectionProvider.java:413) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.http.client.HttpClientOperations.onInboundNext(HttpClientOperations.java:550) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.channel.ChannelOperationsHandler.channelRead(ChannelOperationsHandler.java:90) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:321) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:308) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:422) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:276) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:714) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:650) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:576) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:493) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_191]

2021-01-14 17:12:09.345 DEBUG [api-gateway,,,] 2148 --- [ctor-http-nio-3] i.g.r.c.i.CircuitBreakerStateMachine     : Event ERROR published: 2021-01-14T17:12:09.345+09:00[Asia/Seoul]: CircuitBreaker 'MY_CIRCUIT_BREAKER' recorded an error: 'io.github.bhhan.example.apigateway.proxy.UnknownProxyException: Unknown: 500 INTERNAL_SERVER_ERROR'. Elapsed time: 36 ms
2021-01-14 17:12:09.368  INFO [api-gateway,,,] 2148 --- [tp1285875672-40] WireMock                                 : Request received:
127.0.0.1 - GET /customers/99

Accept: [*/*]
X-B3-SpanId: [5d749ff79090b4c8]
User-Agent: [ReactorNetty/0.9.5.RELEASE]
X-B3-Sampled: [1]
Host: [localhost:10879]
X-B3-TraceId: [5d749ff79090b4c8]
Accept-Encoding: [gzip]



Matched response definition:
{
  &quot;status&quot; : 500,
  &quot;body&quot; : &quot;{}&quot;,
  &quot;headers&quot; : {
    &quot;Content-Type&quot; : &quot;application/json&quot;
  }
}

Response:
HTTP/1.1 500
Content-Type: [application/json]
Matched-Stub-Id: [f49d770b-85ae-4fb1-a5f4-c283064d534b]


2021-01-14 17:12:09.375 DEBUG [api-gateway,,,] 2148 --- [ctor-http-nio-2] i.g.r.c.i.CircuitBreakerStateMachine     : CircuitBreaker 'MY_CIRCUIT_BREAKER' recorded an exception as failure:

io.github.bhhan.example.apigateway.proxy.UnknownProxyException: Unknown: 500 INTERNAL_SERVER_ERROR
	at io.github.bhhan.example.apigateway.proxy.CustomerServiceProxy.lambda$findCustomerById$0(CustomerServiceProxy.java:46) ~[main/:na]
	at reactor.core.publisher.MonoFlatMap$FlatMapMain.onNext(MonoFlatMap.java:118) ~[reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber.onNext(FluxSwitchIfEmpty.java:67) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxOnAssembly$OnAssemblySubscriber.onNext(FluxOnAssembly.java:385) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at org.springframework.cloud.sleuth.instrument.web.client.TraceExchangeFilterFunction$WebClientTracerSubscriber.onNext(TraceWebClientBeanPostProcessor.java:269) [spring-cloud-sleuth-core-2.2.2.RELEASE.jar:2.2.2.RELEASE]
	at org.springframework.cloud.sleuth.instrument.web.client.TraceExchangeFilterFunction$WebClientTracerSubscriber.onNext(TraceWebClientBeanPostProcessor.java:202) [spring-cloud-sleuth-core-2.2.2.RELEASE.jar:2.2.2.RELEASE]
	at reactor.core.publisher.FluxMap$MapSubscriber.onNext(FluxMap.java:114) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxPeek$PeekSubscriber.onNext(FluxPeek.java:192) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxPeek$PeekSubscriber.onNext(FluxPeek.java:192) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoNext$NextSubscriber.onNext(MonoNext.java:76) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyInner.onNext(MonoFlatMapMany.java:242) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2267) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyMain.onSubscribeInner(MonoFlatMapMany.java:143) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyInner.onSubscribe(MonoFlatMapMany.java:237) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:54) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.Flux.subscribe(Flux.java:8186) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyMain.onNext(MonoFlatMapMany.java:188) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxRetryPredicate$RetryPredicateSubscriber.onNext(FluxRetryPredicate.java:82) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoCreate$DefaultMonoSink.success(MonoCreate.java:156) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.netty.http.client.HttpClientConnect$HttpObserver.onStateChange(HttpClientConnect.java:398) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.ReactorNetty$CompositeConnectionObserver.onStateChange(ReactorNetty.java:514) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.resources.PooledConnectionProvider$DisposableAcquire.onStateChange(PooledConnectionProvider.java:501) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.resources.PooledConnectionProvider$PooledConnection.onStateChange(PooledConnectionProvider.java:413) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.http.client.HttpClientOperations.onInboundNext(HttpClientOperations.java:550) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.channel.ChannelOperationsHandler.channelRead(ChannelOperationsHandler.java:90) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:321) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:308) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:422) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:276) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:714) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:650) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:576) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:493) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_191]

2021-01-14 17:12:09.380 DEBUG [api-gateway,,,] 2148 --- [ctor-http-nio-2] i.g.r.c.i.CircuitBreakerStateMachine     : Event ERROR published: 2021-01-14T17:12:09.380+09:00[Asia/Seoul]: CircuitBreaker 'MY_CIRCUIT_BREAKER' recorded an error: 'io.github.bhhan.example.apigateway.proxy.UnknownProxyException: Unknown: 500 INTERNAL_SERVER_ERROR'. Elapsed time: 15 ms
2021-01-14 17:12:09.425  INFO [api-gateway,,,] 2148 --- [tp1285875672-34] WireMock                                 : Request received:
127.0.0.1 - GET /customers/99

Accept: [*/*]
X-B3-SpanId: [22b2037a3ebc944c]
User-Agent: [ReactorNetty/0.9.5.RELEASE]
X-B3-Sampled: [1]
Host: [localhost:10879]
X-B3-TraceId: [22b2037a3ebc944c]
Accept-Encoding: [gzip]



Matched response definition:
{
  &quot;status&quot; : 500,
  &quot;body&quot; : &quot;{}&quot;,
  &quot;headers&quot; : {
    &quot;Content-Type&quot; : &quot;application/json&quot;
  }
}

Response:
HTTP/1.1 500
Content-Type: [application/json]
Matched-Stub-Id: [f49d770b-85ae-4fb1-a5f4-c283064d534b]


2021-01-14 17:12:09.430 DEBUG [api-gateway,,,] 2148 --- [ctor-http-nio-3] i.g.r.c.i.CircuitBreakerStateMachine     : CircuitBreaker 'MY_CIRCUIT_BREAKER' recorded an exception as failure:

io.github.bhhan.example.apigateway.proxy.UnknownProxyException: Unknown: 500 INTERNAL_SERVER_ERROR
	at io.github.bhhan.example.apigateway.proxy.CustomerServiceProxy.lambda$findCustomerById$0(CustomerServiceProxy.java:46) ~[main/:na]
	at reactor.core.publisher.MonoFlatMap$FlatMapMain.onNext(MonoFlatMap.java:118) ~[reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber.onNext(FluxSwitchIfEmpty.java:67) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxOnAssembly$OnAssemblySubscriber.onNext(FluxOnAssembly.java:385) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at org.springframework.cloud.sleuth.instrument.web.client.TraceExchangeFilterFunction$WebClientTracerSubscriber.onNext(TraceWebClientBeanPostProcessor.java:269) [spring-cloud-sleuth-core-2.2.2.RELEASE.jar:2.2.2.RELEASE]
	at org.springframework.cloud.sleuth.instrument.web.client.TraceExchangeFilterFunction$WebClientTracerSubscriber.onNext(TraceWebClientBeanPostProcessor.java:202) [spring-cloud-sleuth-core-2.2.2.RELEASE.jar:2.2.2.RELEASE]
	at reactor.core.publisher.FluxMap$MapSubscriber.onNext(FluxMap.java:114) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxPeek$PeekSubscriber.onNext(FluxPeek.java:192) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxPeek$PeekSubscriber.onNext(FluxPeek.java:192) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoNext$NextSubscriber.onNext(MonoNext.java:76) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyInner.onNext(MonoFlatMapMany.java:242) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2267) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyMain.onSubscribeInner(MonoFlatMapMany.java:143) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyInner.onSubscribe(MonoFlatMapMany.java:237) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:54) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.Flux.subscribe(Flux.java:8186) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyMain.onNext(MonoFlatMapMany.java:188) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxRetryPredicate$RetryPredicateSubscriber.onNext(FluxRetryPredicate.java:82) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoCreate$DefaultMonoSink.success(MonoCreate.java:156) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.netty.http.client.HttpClientConnect$HttpObserver.onStateChange(HttpClientConnect.java:398) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.ReactorNetty$CompositeConnectionObserver.onStateChange(ReactorNetty.java:514) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.resources.PooledConnectionProvider$DisposableAcquire.onStateChange(PooledConnectionProvider.java:501) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.resources.PooledConnectionProvider$PooledConnection.onStateChange(PooledConnectionProvider.java:413) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.http.client.HttpClientOperations.onInboundNext(HttpClientOperations.java:550) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.channel.ChannelOperationsHandler.channelRead(ChannelOperationsHandler.java:90) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:321) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:308) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:422) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:276) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:714) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:650) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:576) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:493) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_191]

2021-01-14 17:12:09.432 DEBUG [api-gateway,,,] 2148 --- [ctor-http-nio-3] i.g.r.c.i.CircuitBreakerStateMachine     : Event ERROR published: 2021-01-14T17:12:09.432+09:00[Asia/Seoul]: CircuitBreaker 'MY_CIRCUIT_BREAKER' recorded an error: 'io.github.bhhan.example.apigateway.proxy.UnknownProxyException: Unknown: 500 INTERNAL_SERVER_ERROR'. Elapsed time: 32 ms
2021-01-14 17:12:09.612  INFO [api-gateway,,,] 2148 --- [tp1285875672-40] WireMock                                 : Request received:
127.0.0.1 - GET /customers/99

Accept: [*/*]
X-B3-SpanId: [b8bfd612ec645a62]
User-Agent: [ReactorNetty/0.9.5.RELEASE]
X-B3-Sampled: [1]
Host: [localhost:10879]
X-B3-TraceId: [b8bfd612ec645a62]
Accept-Encoding: [gzip]



Matched response definition:
{
  &quot;status&quot; : 500,
  &quot;body&quot; : &quot;{}&quot;,
  &quot;headers&quot; : {
    &quot;Content-Type&quot; : &quot;application/json&quot;
  }
}

Response:
HTTP/1.1 500
Content-Type: [application/json]
Matched-Stub-Id: [f49d770b-85ae-4fb1-a5f4-c283064d534b]


2021-01-14 17:12:09.618 DEBUG [api-gateway,,,] 2148 --- [ctor-http-nio-2] i.g.r.c.i.CircuitBreakerStateMachine     : CircuitBreaker 'MY_CIRCUIT_BREAKER' recorded an exception as failure:

io.github.bhhan.example.apigateway.proxy.UnknownProxyException: Unknown: 500 INTERNAL_SERVER_ERROR
	at io.github.bhhan.example.apigateway.proxy.CustomerServiceProxy.lambda$findCustomerById$0(CustomerServiceProxy.java:46) ~[main/:na]
	at reactor.core.publisher.MonoFlatMap$FlatMapMain.onNext(MonoFlatMap.java:118) ~[reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber.onNext(FluxSwitchIfEmpty.java:67) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxOnAssembly$OnAssemblySubscriber.onNext(FluxOnAssembly.java:385) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at org.springframework.cloud.sleuth.instrument.web.client.TraceExchangeFilterFunction$WebClientTracerSubscriber.onNext(TraceWebClientBeanPostProcessor.java:269) [spring-cloud-sleuth-core-2.2.2.RELEASE.jar:2.2.2.RELEASE]
	at org.springframework.cloud.sleuth.instrument.web.client.TraceExchangeFilterFunction$WebClientTracerSubscriber.onNext(TraceWebClientBeanPostProcessor.java:202) [spring-cloud-sleuth-core-2.2.2.RELEASE.jar:2.2.2.RELEASE]
	at reactor.core.publisher.FluxMap$MapSubscriber.onNext(FluxMap.java:114) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxPeek$PeekSubscriber.onNext(FluxPeek.java:192) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxPeek$PeekSubscriber.onNext(FluxPeek.java:192) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoNext$NextSubscriber.onNext(MonoNext.java:76) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyInner.onNext(MonoFlatMapMany.java:242) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2267) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyMain.onSubscribeInner(MonoFlatMapMany.java:143) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyInner.onSubscribe(MonoFlatMapMany.java:237) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:54) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.Flux.subscribe(Flux.java:8186) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyMain.onNext(MonoFlatMapMany.java:188) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxRetryPredicate$RetryPredicateSubscriber.onNext(FluxRetryPredicate.java:82) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoCreate$DefaultMonoSink.success(MonoCreate.java:156) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.netty.http.client.HttpClientConnect$HttpObserver.onStateChange(HttpClientConnect.java:398) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.ReactorNetty$CompositeConnectionObserver.onStateChange(ReactorNetty.java:514) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.resources.PooledConnectionProvider$DisposableAcquire.onStateChange(PooledConnectionProvider.java:501) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.resources.PooledConnectionProvider$PooledConnection.onStateChange(PooledConnectionProvider.java:413) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.http.client.HttpClientOperations.onInboundNext(HttpClientOperations.java:550) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.channel.ChannelOperationsHandler.channelRead(ChannelOperationsHandler.java:90) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:321) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:308) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:422) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:276) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:714) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:650) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:576) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:493) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_191]

2021-01-14 17:12:09.620 DEBUG [api-gateway,,,] 2148 --- [ctor-http-nio-2] i.g.r.c.i.CircuitBreakerStateMachine     : Event ERROR published: 2021-01-14T17:12:09.620+09:00[Asia/Seoul]: CircuitBreaker 'MY_CIRCUIT_BREAKER' recorded an error: 'io.github.bhhan.example.apigateway.proxy.UnknownProxyException: Unknown: 500 INTERNAL_SERVER_ERROR'. Elapsed time: 16 ms
2021-01-14 17:12:09.630  INFO [api-gateway,,,] 2148 --- [tp1285875672-40] WireMock                                 : Request received:
127.0.0.1 - GET /customers/99

Accept: [*/*]
X-B3-SpanId: [7b216dfc4da6cb28]
User-Agent: [ReactorNetty/0.9.5.RELEASE]
X-B3-Sampled: [1]
Host: [localhost:10879]
X-B3-TraceId: [7b216dfc4da6cb28]
Accept-Encoding: [gzip]



Matched response definition:
{
  &quot;status&quot; : 500,
  &quot;body&quot; : &quot;{}&quot;,
  &quot;headers&quot; : {
    &quot;Content-Type&quot; : &quot;application/json&quot;
  }
}

Response:
HTTP/1.1 500
Content-Type: [application/json]
Matched-Stub-Id: [f49d770b-85ae-4fb1-a5f4-c283064d534b]


2021-01-14 17:12:09.634 DEBUG [api-gateway,,,] 2148 --- [ctor-http-nio-2] i.g.r.c.i.CircuitBreakerStateMachine     : CircuitBreaker 'MY_CIRCUIT_BREAKER' recorded an exception as failure:

io.github.bhhan.example.apigateway.proxy.UnknownProxyException: Unknown: 500 INTERNAL_SERVER_ERROR
	at io.github.bhhan.example.apigateway.proxy.CustomerServiceProxy.lambda$findCustomerById$0(CustomerServiceProxy.java:46) ~[main/:na]
	at reactor.core.publisher.MonoFlatMap$FlatMapMain.onNext(MonoFlatMap.java:118) ~[reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber.onNext(FluxSwitchIfEmpty.java:67) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxOnAssembly$OnAssemblySubscriber.onNext(FluxOnAssembly.java:385) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at org.springframework.cloud.sleuth.instrument.web.client.TraceExchangeFilterFunction$WebClientTracerSubscriber.onNext(TraceWebClientBeanPostProcessor.java:269) [spring-cloud-sleuth-core-2.2.2.RELEASE.jar:2.2.2.RELEASE]
	at org.springframework.cloud.sleuth.instrument.web.client.TraceExchangeFilterFunction$WebClientTracerSubscriber.onNext(TraceWebClientBeanPostProcessor.java:202) [spring-cloud-sleuth-core-2.2.2.RELEASE.jar:2.2.2.RELEASE]
	at reactor.core.publisher.FluxMap$MapSubscriber.onNext(FluxMap.java:114) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxPeek$PeekSubscriber.onNext(FluxPeek.java:192) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxPeek$PeekSubscriber.onNext(FluxPeek.java:192) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoNext$NextSubscriber.onNext(MonoNext.java:76) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyInner.onNext(MonoFlatMapMany.java:242) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2267) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyMain.onSubscribeInner(MonoFlatMapMany.java:143) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyInner.onSubscribe(MonoFlatMapMany.java:237) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:54) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.Flux.subscribe(Flux.java:8186) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyMain.onNext(MonoFlatMapMany.java:188) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxRetryPredicate$RetryPredicateSubscriber.onNext(FluxRetryPredicate.java:82) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoCreate$DefaultMonoSink.success(MonoCreate.java:156) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.netty.http.client.HttpClientConnect$HttpObserver.onStateChange(HttpClientConnect.java:398) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.ReactorNetty$CompositeConnectionObserver.onStateChange(ReactorNetty.java:514) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.resources.PooledConnectionProvider$DisposableAcquire.onStateChange(PooledConnectionProvider.java:501) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.resources.PooledConnectionProvider$PooledConnection.onStateChange(PooledConnectionProvider.java:413) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.http.client.HttpClientOperations.onInboundNext(HttpClientOperations.java:550) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.channel.ChannelOperationsHandler.channelRead(ChannelOperationsHandler.java:90) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:321) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:308) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:422) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:276) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:714) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:650) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:576) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:493) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_191]

2021-01-14 17:12:09.635 DEBUG [api-gateway,,,] 2148 --- [ctor-http-nio-2] i.g.r.c.i.CircuitBreakerStateMachine     : Event ERROR published: 2021-01-14T17:12:09.635+09:00[Asia/Seoul]: CircuitBreaker 'MY_CIRCUIT_BREAKER' recorded an error: 'io.github.bhhan.example.apigateway.proxy.UnknownProxyException: Unknown: 500 INTERNAL_SERVER_ERROR'. Elapsed time: 11 ms
2021-01-14 17:12:09.645  INFO [api-gateway,,,] 2148 --- [tp1285875672-37] WireMock                                 : Request received:
127.0.0.1 - GET /customers/99

Accept: [*/*]
X-B3-SpanId: [9ba40510c32d0a55]
User-Agent: [ReactorNetty/0.9.5.RELEASE]
X-B3-Sampled: [1]
Host: [localhost:10879]
X-B3-TraceId: [9ba40510c32d0a55]
Accept-Encoding: [gzip]



Matched response definition:
{
  &quot;status&quot; : 500,
  &quot;body&quot; : &quot;{}&quot;,
  &quot;headers&quot; : {
    &quot;Content-Type&quot; : &quot;application/json&quot;
  }
}

Response:
HTTP/1.1 500
Content-Type: [application/json]
Matched-Stub-Id: [f49d770b-85ae-4fb1-a5f4-c283064d534b]


2021-01-14 17:12:09.648 DEBUG [api-gateway,,,] 2148 --- [ctor-http-nio-2] i.g.r.c.i.CircuitBreakerStateMachine     : CircuitBreaker 'MY_CIRCUIT_BREAKER' recorded an exception as failure:

io.github.bhhan.example.apigateway.proxy.UnknownProxyException: Unknown: 500 INTERNAL_SERVER_ERROR
	at io.github.bhhan.example.apigateway.proxy.CustomerServiceProxy.lambda$findCustomerById$0(CustomerServiceProxy.java:46) ~[main/:na]
	at reactor.core.publisher.MonoFlatMap$FlatMapMain.onNext(MonoFlatMap.java:118) ~[reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber.onNext(FluxSwitchIfEmpty.java:67) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxOnAssembly$OnAssemblySubscriber.onNext(FluxOnAssembly.java:385) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at org.springframework.cloud.sleuth.instrument.web.client.TraceExchangeFilterFunction$WebClientTracerSubscriber.onNext(TraceWebClientBeanPostProcessor.java:269) [spring-cloud-sleuth-core-2.2.2.RELEASE.jar:2.2.2.RELEASE]
	at org.springframework.cloud.sleuth.instrument.web.client.TraceExchangeFilterFunction$WebClientTracerSubscriber.onNext(TraceWebClientBeanPostProcessor.java:202) [spring-cloud-sleuth-core-2.2.2.RELEASE.jar:2.2.2.RELEASE]
	at reactor.core.publisher.FluxMap$MapSubscriber.onNext(FluxMap.java:114) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxPeek$PeekSubscriber.onNext(FluxPeek.java:192) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxPeek$PeekSubscriber.onNext(FluxPeek.java:192) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoNext$NextSubscriber.onNext(MonoNext.java:76) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyInner.onNext(MonoFlatMapMany.java:242) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2267) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyMain.onSubscribeInner(MonoFlatMapMany.java:143) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyInner.onSubscribe(MonoFlatMapMany.java:237) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:54) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.Flux.subscribe(Flux.java:8186) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyMain.onNext(MonoFlatMapMany.java:188) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxRetryPredicate$RetryPredicateSubscriber.onNext(FluxRetryPredicate.java:82) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoCreate$DefaultMonoSink.success(MonoCreate.java:156) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.netty.http.client.HttpClientConnect$HttpObserver.onStateChange(HttpClientConnect.java:398) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.ReactorNetty$CompositeConnectionObserver.onStateChange(ReactorNetty.java:514) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.resources.PooledConnectionProvider$DisposableAcquire.onStateChange(PooledConnectionProvider.java:501) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.resources.PooledConnectionProvider$PooledConnection.onStateChange(PooledConnectionProvider.java:413) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.http.client.HttpClientOperations.onInboundNext(HttpClientOperations.java:550) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.channel.ChannelOperationsHandler.channelRead(ChannelOperationsHandler.java:90) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:321) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:308) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:422) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:276) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:714) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:650) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:576) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:493) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_191]

2021-01-14 17:12:09.649 DEBUG [api-gateway,,,] 2148 --- [ctor-http-nio-2] i.g.r.c.i.CircuitBreakerStateMachine     : Event ERROR published: 2021-01-14T17:12:09.649+09:00[Asia/Seoul]: CircuitBreaker 'MY_CIRCUIT_BREAKER' recorded an error: 'io.github.bhhan.example.apigateway.proxy.UnknownProxyException: Unknown: 500 INTERNAL_SERVER_ERROR'. Elapsed time: 8 ms
2021-01-14 17:12:09.678  INFO [api-gateway,,,] 2148 --- [tp1285875672-37] WireMock                                 : Request received:
127.0.0.1 - GET /customers/99

Accept: [*/*]
X-B3-SpanId: [8298336697bcbed7]
User-Agent: [ReactorNetty/0.9.5.RELEASE]
X-B3-Sampled: [1]
Host: [localhost:10879]
X-B3-TraceId: [8298336697bcbed7]
Accept-Encoding: [gzip]



Matched response definition:
{
  &quot;status&quot; : 500,
  &quot;body&quot; : &quot;{}&quot;,
  &quot;headers&quot; : {
    &quot;Content-Type&quot; : &quot;application/json&quot;
  }
}

Response:
HTTP/1.1 500
Content-Type: [application/json]
Matched-Stub-Id: [f49d770b-85ae-4fb1-a5f4-c283064d534b]


2021-01-14 17:12:09.683 DEBUG [api-gateway,,,] 2148 --- [ctor-http-nio-2] i.g.r.c.i.CircuitBreakerStateMachine     : CircuitBreaker 'MY_CIRCUIT_BREAKER' recorded an exception as failure:

io.github.bhhan.example.apigateway.proxy.UnknownProxyException: Unknown: 500 INTERNAL_SERVER_ERROR
	at io.github.bhhan.example.apigateway.proxy.CustomerServiceProxy.lambda$findCustomerById$0(CustomerServiceProxy.java:46) ~[main/:na]
	at reactor.core.publisher.MonoFlatMap$FlatMapMain.onNext(MonoFlatMap.java:118) ~[reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber.onNext(FluxSwitchIfEmpty.java:67) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxOnAssembly$OnAssemblySubscriber.onNext(FluxOnAssembly.java:385) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at org.springframework.cloud.sleuth.instrument.web.client.TraceExchangeFilterFunction$WebClientTracerSubscriber.onNext(TraceWebClientBeanPostProcessor.java:269) [spring-cloud-sleuth-core-2.2.2.RELEASE.jar:2.2.2.RELEASE]
	at org.springframework.cloud.sleuth.instrument.web.client.TraceExchangeFilterFunction$WebClientTracerSubscriber.onNext(TraceWebClientBeanPostProcessor.java:202) [spring-cloud-sleuth-core-2.2.2.RELEASE.jar:2.2.2.RELEASE]
	at reactor.core.publisher.FluxMap$MapSubscriber.onNext(FluxMap.java:114) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxPeek$PeekSubscriber.onNext(FluxPeek.java:192) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxPeek$PeekSubscriber.onNext(FluxPeek.java:192) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoNext$NextSubscriber.onNext(MonoNext.java:76) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyInner.onNext(MonoFlatMapMany.java:242) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2267) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyMain.onSubscribeInner(MonoFlatMapMany.java:143) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyInner.onSubscribe(MonoFlatMapMany.java:237) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:54) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.Flux.subscribe(Flux.java:8186) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoFlatMapMany$FlatMapManyMain.onNext(MonoFlatMapMany.java:188) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.FluxRetryPredicate$RetryPredicateSubscriber.onNext(FluxRetryPredicate.java:82) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.core.publisher.MonoCreate$DefaultMonoSink.success(MonoCreate.java:156) [reactor-core-3.3.3.RELEASE.jar:3.3.3.RELEASE]
	at reactor.netty.http.client.HttpClientConnect$HttpObserver.onStateChange(HttpClientConnect.java:398) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.ReactorNetty$CompositeConnectionObserver.onStateChange(ReactorNetty.java:514) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.resources.PooledConnectionProvider$DisposableAcquire.onStateChange(PooledConnectionProvider.java:501) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.resources.PooledConnectionProvider$PooledConnection.onStateChange(PooledConnectionProvider.java:413) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.http.client.HttpClientOperations.onInboundNext(HttpClientOperations.java:550) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at reactor.netty.channel.ChannelOperationsHandler.channelRead(ChannelOperationsHandler.java:90) [reactor-netty-0.9.5.RELEASE.jar:0.9.5.RELEASE]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:321) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:308) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:422) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:276) [netty-codec-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:355) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:377) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:363) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:714) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:650) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:576) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:493) [netty-transport-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.45.Final.jar:4.1.45.Final]
	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_191]

2021-01-14 17:12:09.683 DEBUG [api-gateway,,,] 2148 --- [ctor-http-nio-2] i.g.r.c.i.CircuitBreakerStateMachine     : Event ERROR published: 2021-01-14T17:12:09.683+09:00[Asia/Seoul]: CircuitBreaker 'MY_CIRCUIT_BREAKER' recorded an error: 'io.github.bhhan.example.apigateway.proxy.UnknownProxyException: Unknown: 500 INTERNAL_SERVER_ERROR'. Elapsed time: 7 ms
2021-01-14 17:12:09.707 DEBUG [api-gateway,,,] 2148 --- [ctor-http-nio-2] i.g.r.c.i.CircuitBreakerStateMachine     : Event STATE_TRANSITION published: 2021-01-14T17:12:09.707+09:00[Asia/Seoul]: CircuitBreaker 'MY_CIRCUIT_BREAKER' changed state from CLOSED to OPEN
2021-01-14 17:12:09.716 DEBUG [api-gateway,,,] 2148 --- [    Test worker] i.g.r.c.i.CircuitBreakerStateMachine     : Event NOT_PERMITTED published: 2021-01-14T17:12:09.716+09:00[Asia/Seoul]: CircuitBreaker 'MY_CIRCUIT_BREAKER' recorded a call which was not permitted.
2021-01-14 17:12:09.730  INFO [api-gateway,,,] 2148 --- [    Test worker] w.o.e.jetty.server.AbstractConnector     : Stopped NetworkTrafficServerConnector@15824b7b{HTTP/1.1,[http/1.1]}{0.0.0.0:10879}
2021-01-14 17:12:09.731  INFO [api-gateway,,,] 2148 --- [    Test worker] w.o.e.j.server.handler.ContextHandler    : Stopped w.o.e.j.s.ServletContextHandler@725179b0{/,null,UNAVAILABLE}
2021-01-14 17:12:09.732  INFO [api-gateway,,,] 2148 --- [    Test worker] w.o.e.j.server.handler.ContextHandler    : Stopped w.o.e.j.s.ServletContextHandler@7031fd0a{/__admin,null,UNAVAILABLE}
2021-01-14 17:12:09.742  INFO [api-gateway,,,] 2148 --- [    Test worker] w.org.eclipse.jetty.server.Server        : jetty-9.4.20.v20190813; built: 2019-08-13T21:28:18.144Z; git: 84700530e645e812b336747464d6fbbf370c9a20; jvm 1.8.0_191-b12
2021-01-14 17:12:09.745  INFO [api-gateway,,,] 2148 --- [    Test worker] w.o.e.j.server.handler.ContextHandler    : Started w.o.e.j.s.ServletContextHandler@7626590d{/__admin,null,AVAILABLE}
2021-01-14 17:12:09.746  INFO [api-gateway,,,] 2148 --- [    Test worker] w.o.e.j.server.handler.ContextHandler    : Started w.o.e.j.s.ServletContextHandler@1296f8e1{/,null,AVAILABLE}
2021-01-14 17:12:09.796  INFO [api-gateway,,,] 2148 --- [    Test worker] w.o.e.jetty.server.AbstractConnector     : Started NetworkTrafficServerConnector@11961dda{HTTP/1.1,[http/1.1]}{0.0.0.0:10879}
2021-01-14 17:12:09.796  INFO [api-gateway,,,] 2148 --- [    Test worker] w.org.eclipse.jetty.server.Server        : Started @40928ms
</pre>
</span>
</div>
</div>
<div id="footer">
<p>
<div>
<label class="hidden" id="label-for-line-wrapping-toggle" for="line-wrapping-toggle">Wrap lines
<input id="line-wrapping-toggle" type="checkbox" autocomplete="off"/>
</label>
</div>Generated by 
<a href="http://www.gradle.org">Gradle 5.2.1</a> at 2021. 1. 14  5:12:12</p>
</div>
</div>
</body>
</html>
